<!DOCTYPE html>
<html lang="en">
<head>
	<title>My First Example</title>
	<meta charset="utf-8">
</head>
<body>
<script>
	// 郵便番号の場合 - Postal code
	function validatePostalCode(value) {
		// 郵便番号（ハイフンあり・なし両方） - Zip code (both with and without hyphens)
		return /^[0-9]{3}\-?[0-9]{4}$/.test(value);
	}

	//var str = '1710031';
	//var str = '171-0031';
	var str = '1400012';
	console.log(str, validatePostalCode(str));

	var endpoint = './api/v1';
	var code1 = str.replace(/^([0-9]{3}).*/, "$1");
	var code2 = str.replace(/.*([0-9]{4})$/, "$1");
	var url = endpoint + '/' + code1 +'/' + code2 + '.json';
	console.log(code1, code2, url);

	var xmlhttp = new XMLHttpRequest();
	xmlhttp.open('GET', url, true);
	xmlhttp.onreadystatechange = function() {
		if (xmlhttp.readyState == 4) {
			if(xmlhttp.status == 200) {
				var obj = JSON.parse(xmlhttp.responseText);
				console.log(xmlhttp.responseText);
				console.log(obj);
				console.log(obj.data);
				for (const x in obj.data) {
					var address = obj.data[x];
					console.log(x, address);
					console.log(address.ja.prefecture, address.ja.address1, address.ja.address2, address.ja.address3, address.ja.address4);
					console.log(address.en.prefecture, address.en.address1, address.en.address2, address.en.address3, address.en.address4);
				}
			}
		}
	};
	xmlhttp.send(null);

</script>
</body>
</html>